<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Scientific.Functions.LeastSquares</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar"
        href="Scientific-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar"
        href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar"
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar"
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center">
            <p class="nomargin">
              <a class="navbar" target="_top" href="http://dirac.cnrs-orleans.fr/ScientificPython/">Scientific Python</a>
      </p></th></tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="Scientific-module.html">Package&nbsp;Scientific</a> ::
        <a href="Scientific.Functions-module.html">Package&nbsp;Functions</a> ::
        Module&nbsp;LeastSquares
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript: void(0);" class="privatelink"
    onclick="toggle_private();">hide private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="Scientific.Functions.LeastSquares-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h2 class="module">Module LeastSquares
<br/><span class="codelink"><a href="Scientific.Functions.LeastSquares-pysrc.html">source&nbsp;code</a></span></h2>
<p>Non-linear least squares fitting</p>
  Usage example:
<pre class="literalblock">
   from Numeric import exp

   def f(param, t):
       return param[0]*exp(-param[1]/t)

   data_quantum = [(100, 3.445e+6),(200, 2.744e+7),
                   (300, 2.592e+8),(400, 1.600e+9)]
   data_classical = [(100, 4.999e-8),(200, 5.307e+2),
                     (300, 1.289e+6),(400, 6.559e+7)]

   print leastSquaresFit(f, (1e13,4700), data_classical)

   def f2(param, t):
       return 1e13*exp(-param[0]/t)

   print leastSquaresFit(f2, (3000.,), data_quantum)
</pre><br /><br />

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="summary">
  <td colspan="2" class="summary">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><h3 class="summary">Functions</h3></th>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr class="private">
  <td width="15%" align="right" valign="top" class="summary">
    <span class="rtype">
      &nbsp;
    </span>
   </td>
  <td class="summary">
    <span class="sig"><a href="Scientific.Functions.LeastSquares-module.html#_chiSquare" class="sig-name">_chiSquare</a>(<span class="sig-arg">model</span>,
        <span class="sig-arg">parameters</span>,
        <span class="sig-arg">data</span>)</span>
    
  </td>
</tr>
<tr class="private">
  <td width="15%" align="right" valign="top" class="summary">
    <span class="rtype">
      &nbsp;
    </span>
   </td>
  <td class="summary">
    <span class="sig"><a href="Scientific.Functions.LeastSquares-module.html#_polynomialModel" class="sig-name">_polynomialModel</a>(<span class="sig-arg">params</span>,
        <span class="sig-arg">t</span>)</span>
    
  </td>
</tr>
<tr>
  <td width="15%" align="right" valign="top" class="summary">
    <span class="rtype">
      <code>(list, float)</code>
    </span>
   </td>
  <td class="summary">
    <span class="sig"><a href="Scientific.Functions.LeastSquares-module.html#leastSquaresFit" class="sig-name">leastSquaresFit</a>(<span class="sig-arg">model</span>,
        <span class="sig-arg">parameters</span>,
        <span class="sig-arg">data</span>,
        <span class="sig-arg">max_iterations</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">stopping_limit</span>=<span class="sig-default">0.0050000000000000001</span>)</span>
    <br />General non-linear least-squares fit using the <a 
      name="index-Levenberg_Marquardt"></a><i 
      class="indexterm">Levenberg-Marquardt</i> algorithm and <a 
      name="index-automatic_differentiation"></a><i 
      class="indexterm">automatic differentiation</i>.
  </td>
</tr>
<tr>
  <td width="15%" align="right" valign="top" class="summary">
    <span class="rtype">
      &nbsp;
    </span>
   </td>
  <td class="summary">
    <span class="sig"><a href="Scientific.Functions.LeastSquares-module.html#polynomialLeastSquaresFit" class="sig-name">polynomialLeastSquaresFit</a>(<span class="sig-arg">parameters</span>,
        <span class="sig-arg">data</span>)</span>
    <br />Least-squares fit to a polynomial whose order is defined by the 
      number of parameter values.
  </td>
</tr>
</table>

<br />
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="details">
  <td colspan="2" class="details">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><h3 class="details">Function Details</h3></th>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="_chiSquare"></a>
<div class="private">
<table width="100%" class="details" bgcolor="#e0e0e0"><tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3><span class="sig"><span class="sig-name">_chiSquare</span>(<span class="sig-arg">model</span>,
        <span class="sig-arg">parameters</span>,
        <span class="sig-arg">data</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Scientific.Functions.LeastSquares-pysrc.html#_chiSquare">source&nbsp;code</a></span>&nbsp;</span
    ></td>
  </table>
  
  
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>
</div>
<a name="_polynomialModel"></a>
<div class="private">
<table width="100%" class="details" bgcolor="#e0e0e0"><tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3><span class="sig"><span class="sig-name">_polynomialModel</span>(<span class="sig-arg">params</span>,
        <span class="sig-arg">t</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Scientific.Functions.LeastSquares-pysrc.html#_polynomialModel">source&nbsp;code</a></span>&nbsp;</span
    ></td>
  </table>
  
  
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>
</div>
<a name="leastSquaresFit"></a>
<div>
<table width="100%" class="details" bgcolor="#e0e0e0"><tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3><span class="sig"><span class="sig-name">leastSquaresFit</span>(<span class="sig-arg">model</span>,
        <span class="sig-arg">parameters</span>,
        <span class="sig-arg">data</span>,
        <span class="sig-arg">max_iterations</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">stopping_limit</span>=<span class="sig-default">0.0050000000000000001</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Scientific.Functions.LeastSquares-pysrc.html#leastSquaresFit">source&nbsp;code</a></span>&nbsp;</span
    ></td>
  </table>
  
  General non-linear least-squares fit using the <a 
  name="index-Levenberg_Marquardt"></a><i 
  class="indexterm">Levenberg-Marquardt</i> algorithm and <a 
  name="index-automatic_differentiation"></a><i class="indexterm">automatic
  differentiation</i>.
  <dl><dt></dt><dd>
    <dl><dt>Parameters:</dt></dl>
    <ul>
        <li><strong class="pname"><code>model</code></strong> - the function to be fitted. It will be called with two 
          parameters: the first is a tuple containing all fit parameters, 
          and the second is the first element of a data point (see below). 
          The return value must be a number.  Since automatic 
          differentiation is used to obtain the derivatives with respect to
          the parameters, the function may only use the mathematical 
          functions known to the module FirstDerivatives.</li>
        <li><strong class="pname"><code>parameters</code></strong> (<code><code>tuple</code> of numbers</code>) - a tuple of initial values for the fit parameters</li>
        <li><strong class="pname"><code>data</code></strong> (<code><code>list</code></code>) - a list of data points to which the model is to be fitted. Each
          data point is a tuple of length two or three. Its first element 
          specifies the independent variables of the model. It is passed to
          the model function as its first parameter, but not used in any 
          other way. The second element of each data point tuple is the 
          number that the return value of the model function is supposed to
          match as well as possible. The third element (which defaults to 
          1.) is the statistical variance of the data point, i.e. the 
          inverse of its statistical weight in the fitting procedure.</li>
    </ul>
    <dl><dt>Returns: <code><code>(list, float)</code></code></dt>
        <dd>a list containing the optimal parameter values and the 
          chi-squared value describing the quality of the fit</dd></dl>
  </dd></dl>
</td></tr></table>
</div>
<a name="polynomialLeastSquaresFit"></a>
<div>
<table width="100%" class="details" bgcolor="#e0e0e0"><tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3><span class="sig"><span class="sig-name">polynomialLeastSquaresFit</span>(<span class="sig-arg">parameters</span>,
        <span class="sig-arg">data</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Scientific.Functions.LeastSquares-pysrc.html#polynomialLeastSquaresFit">source&nbsp;code</a></span>&nbsp;</span
    ></td>
  </table>
  
  Least-squares fit to a polynomial whose order is defined by the number
  of parameter values.
  <dl><dt></dt><dd>
    <dl><dt>Parameters:</dt></dl>
    <ul>
        <li><strong class="pname"><code>parameters</code></strong> (<code><code>tuple</code></code>) - a tuple of initial values for the polynomial coefficients</li>
        <li><strong class="pname"><code>data</code></strong> (<code><code>list</code></code>) - the data points, as for <a 
          href="Scientific.Functions.LeastSquares-module.html#leastSquaresFit"
          class="link">leastSquaresFit</a></li>
    </ul>
      <p><strong>Note:</strong>
        This could also be done with a linear least squares fit from 
        <code class="link">LinearAlgebra</code>
      </p>
      </ul>
  </dd></dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar"
        href="Scientific-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar"
        href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar"
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar"
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center">
            <p class="nomargin">
              <a class="navbar" target="_top" href="http://dirac.cnrs-orleans.fr/ScientificPython/">Scientific Python</a>
      </p></th></tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">Generated by Epydoc
        3.0alpha2 on Tue Jun 13 11:39:40 2006</td>
    <td align="right" class="footer">
      <a href="http://epydoc.sourceforge.net">http://epydoc.sf.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie()
  // -->
</script>
  
</body>
</html>
